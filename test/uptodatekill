#target: test1 test2 test3

uncached(key)
   cache uptodate = getCache("test" key)
   fail(condition:uptodate)

cached(key value)
   cache uptodate data = getCache("test" key)
   fail(condition:!uptodate)
   fail("value:"data" expected:"value condition:(data != value))

update(key value)
   cache uptodate = getCache("test" key)
   setUptodate(cache data:value)

die()
   exec('kill '-s 'KILL pid())

test1:
   uncached(0)
   update(0 "v1")
   uncached(1)
   cached(0 "v1")
   echo("PASS")
   die()

test2:
   cached(0 "v1")
   uncached(1)
   update(1 "v2")
   echo("PASS")
   die()

test3:
   cached(0 "v1")
   cached(1 "v2")
   echo("PASS")
